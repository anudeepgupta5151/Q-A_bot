{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "cf619f19",
   "metadata": {},
   "source": [
    "### Install required packages"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8ec46d2b",
   "metadata": {},
   "outputs": [],
   "source": [
    "pip install langchain==0.0.284"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ea337b99",
   "metadata": {},
   "outputs": [],
   "source": [
    "pip install InstructorEmbedding==1.0.1 sentence_transformers==2.2.2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dd9fb293",
   "metadata": {},
   "outputs": [],
   "source": [
    "pip install torch==2.1.1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f447367e",
   "metadata": {},
   "outputs": [],
   "source": [
    "pip install chromadb faiss-cpu"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "c84e5e66",
   "metadata": {},
   "outputs": [],
   "source": [
    "import os \n",
    "os.chdir ('C:\\Q&A bot')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "ced99a2f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'C:\\\\Q&A bot'"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pwd"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "256584cb",
   "metadata": {},
   "source": [
    "### load data from sample FAQ csv file"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "e5886fea",
   "metadata": {},
   "outputs": [],
   "source": [
    "from langchain.document_loaders.csv_loader import CSVLoader\n",
    "\n",
    "loader = CSVLoader(file_path='sample_faqs.csv', source_column=\"prompt\")\n",
    "\n",
    "# Store the loaded data in the 'faq_data' variable\n",
    "faq_data = loader.load()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7a18f94d",
   "metadata": {},
   "source": [
    "### Initialize and test Hugging Face Embeddings"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "6e86f317",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\002ZAI744\\anaconda3\\Lib\\site-packages\\InstructorEmbedding\\instructor.py:7: TqdmExperimentalWarning: Using `tqdm.autonotebook.tqdm` in notebook mode. Use `tqdm.tqdm` instead to force console mode (e.g. in jupyter console)\n",
      "  from tqdm.autonotebook import trange\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "load INSTRUCTOR_Transformer\n",
      "max_seq_length  512\n"
     ]
    }
   ],
   "source": [
    "from langchain.embeddings import HuggingFaceInstructEmbeddings\n",
    "\n",
    "# Initializing embeddings using the Hugging Face model\n",
    "model_name = \"hkunlp/instructor-large\"\n",
    "encode_kwargs = {'normalize_embeddings': True}\n",
    "hf = HuggingFaceInstructEmbeddings(\n",
    "    model_name=model_name,\n",
    "    encode_kwargs=encode_kwargs\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "c12f9f15",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[-0.044302307069301605, 0.028951385989785194, 0.013669581152498722, 0.03900712728500366, 0.019528526812791824, 0.05607006326317787, 0.011876293458044529, 0.048319000750780106, -0.020886817947030067, 0.020501654595136642, 0.05452706664800644, 0.0003703021793626249, 0.031914398074150085, 0.02639397606253624, -0.05080476030707359, 0.025957897305488586, -0.06812917441129684, -0.017648883163928986, -0.02909049205482006, -0.010107495822012424, 0.08262385427951813, -0.050159383565187454, 0.007148680742830038, 0.010125686414539814, -0.003138200379908085, 0.007259678095579147, -0.0027497124392539263, 0.08397919684648514, 0.02867589332163334, -0.016637161374092102, 0.03954596444964409, -0.04509137198328972, -0.01663341000676155, 0.0016497912583872676, -0.04204926639795303, -0.0056930361315608025, 0.021692149341106415, -0.003032137406989932, 0.044900767505168915, 0.024995451793074608, 0.02372327633202076, -0.0025761437136679888, 0.005663071293383837, -0.00605751434341073, 0.03788959980010986, 0.0029560732655227184, -0.04984424635767937, -0.014497589319944382, -0.016143448650836945, 0.012741142883896828, -0.036051053553819656, -0.025295764207839966, -0.03985214605927467, -0.011930366978049278, 0.01493886113166809, -0.03542385250329971, -0.07394525408744812, 0.0002965399471577257, 0.06715846061706543, -0.04884921386837959, -0.05378532409667969, 0.007844978012144566, -0.09320374578237534, 0.0030783184338361025, 0.016937019303441048, -0.07391007989645004, 0.04585792496800423, -0.040505919605493546, 0.004900404252111912, -0.039102766662836075, 0.019306199625134468, -0.00743986526504159, -0.005907300394028425, -0.05980897322297096, -0.015705326572060585, -0.029806600883603096, 0.05263332650065422, 0.024464063346385956, -0.018881764262914658, 0.0523957833647728, 0.05178222060203552, -0.027586456388235092, 0.0018540380988270044, -0.007918884046375751, -0.012772290967404842, 0.04236844927072525, -0.03989444300532341, 0.01110068429261446, -0.012103469111025333, 0.023946478962898254, -0.028049128130078316, -0.027314070612192154, 0.0020040604285895824, -0.013261190615594387, -0.019522229209542274, 0.05347241833806038, -0.01493943389505148, -0.0010305673349648714, 0.04909968748688698, 0.06902401894330978, 0.051445674151182175, 0.06883921474218369, -0.056688688695430756, 0.04799780249595642, -0.04473245143890381, 0.00411640340462327, -0.022007880732417107, -0.01621292531490326, -0.05036363750696182, 0.019668105989694595, 0.0011043514823541045, -0.05342203751206398, -0.006372744683176279, 0.02416757494211197, 0.0008478941745124757, -0.0012875546235591173, 0.0599406436085701, -0.04797312989830971, -0.07687190920114517, -0.0434134304523468, 0.02389349602162838, 0.041676852852106094, -0.01592905819416046, 0.0012170549016445875, -0.055566754192113876, 0.01528086792677641, -0.018123144283890724, -0.06846998631954193, -0.025400331243872643, -0.018488213419914246, -0.004645695444196463, 0.030301369726657867, 0.03463336080312729, -0.09492840617895126, 0.05050826817750931, 0.0048875403590500355, -0.06580968201160431, -0.0005827947752550244, 0.006645201705396175, 0.050864722579717636, -0.0811251774430275, -0.06458208709955215, -0.03918343037366867, 0.026841523125767708, -0.03211679309606552, 0.047331806272268295, 0.02810325287282467, -0.052313365042209625, -0.03923289477825165, -0.004382418468594551, 0.02070876955986023, -0.04242835193872452, -0.04979102686047554, 0.09869546443223953, -0.025494566187262535, 0.022710684686899185, -0.011501241475343704, 0.018461797386407852, -0.008959760889410973, -0.029666537418961525, 0.013061698526144028, 0.061257943511009216, 0.006569198332726955, 0.0063154730014503, -0.06522436439990997, -0.02905096486210823, 0.041156504303216934, 0.07323863357305527, -0.013887666165828705, -0.02477199025452137, -0.09022516012191772, -0.015716109424829483, 0.04116548225283623, -0.007106373552232981, -0.05474438890814781, 0.05458670109510422, 0.031717222183942795, 0.016148820519447327, 0.000362524064257741, 0.06881433725357056, 0.01148451678454876, -0.06483253836631775, -0.03007025085389614, 0.04016304388642311, 0.03818308189511299, -0.032768264412879944, -0.008965199813246727, 0.03593134507536888, -0.0007220454281195998, -5.05524585605599e-05, -0.057092513889074326, 0.01528733130544424, 0.007855148054659367, -0.009923643432557583, 0.019225863739848137, -0.03196191415190697, -0.00753776403144002, 0.03641851991415024, 0.022525159642100334, 0.0048433588817715645, -0.030109748244285583, -0.013968274928629398, 0.0030989660881459713, 0.026855526491999626, -0.0197440292686224, 0.019164258614182472, -0.023871775716543198, 0.07166582345962524, -0.021203327924013138, 0.010975755751132965, -0.030916903167963028, -0.06636250764131546, -0.014152802526950836, 0.05744948610663414, 0.07258514314889908, 0.028298547491431236, -0.05080118775367737, -0.04131464660167694, 0.04614282771945, 0.028163541108369827, 0.048149995505809784, 0.02324712835252285, -0.02919500693678856, -0.04135151952505112, 0.03323572874069214, 0.02791379578411579, -0.05097100883722305, -0.020792530849575996, 0.016580305993556976, 0.05268701910972595, -0.049757715314626694, -0.037383727729320526, 0.009906844235956669, 0.046461042016744614, -0.020626811310648918, -0.08135944604873657, 0.04996871575713158, 0.02277439646422863, -0.011416060850024223, 0.03641090914607048, -0.004944120533764362, -0.005870284978300333, 0.07101910561323166, -0.008772366680204868, -0.035021379590034485, -0.012063581496477127, 0.010527375154197216, -0.01389344409108162, 0.06976069509983063, -0.03301386535167694, 0.058526020497083664, -0.01309153437614441, -0.004310389515012503, 0.016476701945066452, -0.0176449753344059, 0.03321035951375961, 0.06261153519153595, 0.030370233580470085, -0.020930076017975807, 0.05330894887447357, 0.004709905944764614, 0.04064825922250748, 0.030635423958301544, 0.0006308690062724054, 0.06039390340447426, 0.009301114827394485, 0.0447637215256691, 0.006113350857049227, 0.018186159431934357, 0.030899029225111008, 0.030670972540974617, 0.05113654211163521, -0.0012789415195584297, -0.020343219861388206, 0.051372725516557693, -0.07587694376707077, 0.04591327905654907, -0.03088950365781784, -0.006799913011491299, 0.006529660429805517, -0.01902313344180584, 0.06408301740884781, 0.004485633224248886, -0.029328476637601852, 0.03566570580005646, -0.01980503462255001, -5.5693639296805486e-05, 0.03696972131729126, 0.025713296607136726, -0.03177294880151749, -0.007911386899650097, 0.0034490381367504597, 0.021802617236971855, -0.03934992104768753, 0.00823818426579237, -0.029618607833981514, -0.01963983289897442, -0.004955448675900698, -0.08412192016839981, -0.006990241352468729, -0.065693199634552, 0.007985751144587994, 0.05992428585886955, 0.012337488122284412, 0.017016181722283363, -0.04956289380788803, 0.034733619540929794, -0.053903184831142426, -0.037241626530885696, -0.03358133137226105, -0.005812067072838545, -0.0365382544696331, -0.08128110319375992, 0.050577063113451004, 0.04138462617993355, 0.006737367250025272, 0.03772826865315437, -0.004056769423186779, -0.06157645955681801, -0.018480708822607994, 0.04015585407614708, 0.05083782225847244, -0.003589918138459325, -0.053809091448783875, 0.011761109344661236, -0.0028504296205937862, -0.014752019196748734, -0.025342881679534912, -0.004792770370841026, 0.08226466923952103, 0.06889555603265762, -0.000935907126404345, 0.015941789373755455, 0.018674785271286964, -0.03623628988862038, -0.02160673961043358, -0.019220376387238503, -0.01966400258243084, -0.03432239964604378, -0.027943171560764313, 0.014330217614769936, -0.0261182002723217, -0.04442640021443367, -0.027772489935159683, -0.019563524052500725, 0.010918653570115566, 0.04036157205700874, 0.03655196353793144, 0.04028807207942009, 0.032214000821113586, -0.03465203940868378, -0.0473443828523159, 0.04887799173593521, 0.01620776392519474, -0.020227085798978806, -0.04670095443725586, -0.033148474991321564, 0.05024492368102074, 0.031997520476579666, 0.024994103237986565, -0.029250813648104668, 0.029606036841869354, 0.03976324945688248, -0.021710330620408058, -0.015110657550394535, -0.04606523737311363, -0.010332937352359295, -0.01080833375453949, -0.03821348771452904, -0.06039492040872574, 0.0018951791571453214, 0.014503968879580498, 0.03295637667179108, 0.05236438661813736, -0.049120642244815826, -0.023280374705791473, 0.012268456630408764, 0.05015173554420471, 0.046167295426130295, 0.030883565545082092, -0.03580588102340698, 0.007388546597212553, -0.07698743790388107, -0.01722671650350094, 0.0008888248121365905, 0.014204761944711208, 0.011545361019670963, 0.03127267584204674, 0.021423473954200745, -0.020504876971244812, -0.013243391178548336, 0.04618275910615921, 0.02960219979286194, 0.026585230603814125, -0.02141125313937664, 0.01552790217101574, -0.0248517245054245, 0.03977761045098305, 0.002921821316704154, -0.004056060686707497, -0.04076136276125908, -0.06271664053201675, -0.03728731349110603, -0.002717836992815137, -0.025269759818911552, -0.01751493290066719, 0.04743561893701553, -0.0007575335330329835, 0.00471601914614439, 0.02379428967833519, 0.026827417314052582, 0.01489651296287775, -0.02185489982366562, 0.059051163494586945, -0.029307840391993523, 0.01957705244421959, -0.005552090238779783, -0.017513873055577278, -0.01263442263007164, -0.030746329575777054, 0.009216920472681522, 0.06307023763656616, 0.012744560837745667, 0.04909485578536987, 0.07188083231449127, 0.04794928804039955, -0.037654124200344086, 0.04921587556600571, 0.05666832625865936, 0.007359295152127743, -0.04270368441939354, 0.012543120421469212, -0.01658075675368309, -0.025385743007063866, 0.008821437135338783, -0.018757307901978493, 0.03709757700562477, 0.049702513962984085, -0.033775024116039276, 0.015916157513856888, 0.009166441857814789, 0.03898302838206291, -0.03991265222430229, -0.033963803201913834, -0.006362701766192913, 0.023058850318193436, -0.0058794221840798855, 0.03245459124445915, 0.03893275558948517, 0.013200026005506516, 0.05891841650009155, -0.014619742520153522, -0.045840226113796234, -0.03255006670951843, 0.05109455808997154, 0.02063365839421749, -0.00530093302950263, -0.05768660083413124, -0.02926371619105339, 0.02490335889160633, -0.0021899640560150146, -0.01885678991675377, -0.039794910699129105, 0.016626184806227684, 0.04581410810351372, -0.031157199293375015, 0.06036936119198799, -0.020775223150849342, 0.04216660559177399, 0.031852591782808304, -0.02254064753651619, 0.01947658322751522, -0.022711388766765594, 0.0037806022446602583, 0.0015286073321476579, 0.03161844611167908, -0.006288384553045034, -0.022213857620954514, -0.05564415827393532, 0.036627549678087234, 0.02483266219496727, 0.04500498250126839, 0.0345003679394722, -0.015475261956453323, 0.0056701647117733955, -0.02156687341630459, 0.0519711896777153, -0.05151679366827011, 0.017525725066661835, 0.05550285801291466, 0.011348511092364788, -0.06572166085243225, -0.024119310081005096, 0.004427541047334671, 0.0009649181156419218, 0.0372774675488472, -0.03888081759214401, -0.05970165878534317, -0.050089333206415176, 0.012742029502987862, -0.0005678421584889293, -0.05262492969632149, -0.03791212663054466, 0.027914034202694893, 0.013345933519303799, -0.034534309059381485, 0.04204868525266647, 0.026537369936704636, 0.05441611260175705, 0.06351229548454285, 0.015077637508511543, 0.035329654812812805, -0.04002629965543747, 0.030296608805656433, -0.03616625815629959, -0.04155838489532471, 0.007259233854711056, -0.06520266830921173, -0.05343683809041977, -0.034981075674295425, -0.047178104519844055, -0.04974973201751709, 0.0035923875402659178, 0.0186933483928442, 0.018424997106194496, 0.023411385715007782, 0.008345239795744419, 0.010305026546120644, 0.032432131469249725, -0.031201887875795364, -0.002986364532262087, -0.02663738839328289, -0.056979477405548096, -0.02579924836754799, 0.023758282884955406, 0.012192212976515293, 0.026350056752562523, 0.002462146570906043, 0.03241274505853653, 0.05522388592362404, 0.03783503547310829, -0.030721887946128845, 0.045103009790182114, 0.020385880023241043, -0.006084195338189602, 0.016972675919532776, -0.0004137991927564144, 0.03206617757678032, 0.03585214540362358, -0.045002348721027374, -0.0052636596374213696, -0.0015881172148510814, 0.013984689489006996, -0.04779941961169243, 0.035324182361364365, -0.022375071421265602, -0.05503883585333824, 0.0025562068913131952, 0.0013973392779007554, 0.01022374164313078, 0.03585522249341011, -0.04167826473712921, -0.05809701979160309, 0.027269234880805016, -0.013895834796130657, 0.019091511145234108, 0.04354468360543251, -0.03955289348959923, 0.04055175185203552, -0.053250059485435486, 0.022237155586481094, -0.030221257358789444, 0.02792091853916645, -0.0392468124628067, 0.03376023843884468, 0.007813233882188797, 0.029812291264533997, -0.06683487445116043, 0.034587886184453964, -0.049207109957933426, -0.03488519415259361, -0.005762680433690548, 0.08382636308670044, -0.016886280849575996, 0.001355002517811954, -0.016202792525291443, 0.0080679627135396, -0.03425397723913193, -0.01597205549478531, -0.040824368596076965, 0.041560493409633636, -0.009180615656077862, 0.042051639407873154, -0.05321525037288666, 0.0021222522482275963, -0.006399140693247318, -0.03848983347415924, 0.02152104675769806, 0.04956210032105446, -0.01822514645755291, 0.0052847969345748425, -0.013550909236073494, 0.018602505326271057, -0.021175572648644447, -0.019120389595627785, -0.02063259482383728, -0.0017283238703384995, -0.023070581257343292, 0.025370677933096886, 0.007755561266094446, 0.06231040880084038, -0.08065012842416763, -0.05076529458165169, 0.03404679521918297, 0.045484140515327454, 0.01716124452650547, 0.008062749169766903, 0.00892841536551714, -0.016153231263160706, 0.0047211856581270695, -0.045173969119787216, 0.015321302227675915, -0.032030802220106125, 0.018292877823114395, 0.003860300872474909, -0.025798538699746132, 0.039167627692222595, 0.007709156721830368, -0.021367428824305534, 0.0337255522608757, 0.07554967701435089, 0.027503231540322304, -0.007051533088088036, 0.010051429271697998, -0.08224211633205414, 0.02293589897453785, 0.02193799987435341, -0.020312990993261337, 0.04180315136909485, 0.013614770025014877, -0.03427491337060928, 0.03016013652086258, -0.005831994116306305, 0.010914251208305359, 0.028427831828594208, 0.034890592098236084, -0.04520846903324127, 0.023404978215694427, -0.05631721392273903, 0.028912074863910675, 0.015257387422025204, -0.06551526486873627, -0.009586678817868233, -0.03933568298816681, 0.0833207368850708, -0.043700411915779114, 0.0903860405087471, 0.037699226289987564, 0.00752330431714654, 0.009589624591171741, -0.05029875412583351, -0.04884668439626694, -0.015804855152964592, -0.04140355437994003, 0.019216779619455338, -0.03993901237845421, -0.0731935054063797, 0.028559420257806778, 0.0021180524490773678, -0.057584382593631744, -0.0218680277466774, 0.027433620765805244, 0.03614441677927971, 0.0401604026556015, 0.02329321764409542, -0.01633240282535553, 0.003555658971890807, -0.06268871575593948, 0.03138401731848717, -0.0144434729591012, -0.02440674416720867, -0.00557688158005476, -0.006806426215916872, 0.006807164289057255, 0.031823545694351196, -0.016750531271100044, 0.010695238597691059, 0.03403983637690544, -0.02666417695581913, -0.058247096836566925, 0.0005207458743825555, 0.021570079028606415, -0.017686760053038597, -0.00888371467590332, -0.029578223824501038, 0.0021898457780480385, 0.045753054320812225, -0.023383384570479393, -0.0033451670315116644, -0.026701487600803375, -0.04125720635056496, -0.06615317612886429, -0.024273430928587914, -0.0024964287877082825, -7.961447408888489e-05, -0.03218326345086098, 0.00724553968757391, 0.03999374434351921, -0.005278430413454771, -0.006708256434649229, -0.006162043660879135, 0.015876397490501404, -0.06672003865242004, -0.03132710978388786, 0.00887005589902401, 0.02317771688103676, 0.04640568420290947, -0.02703704684972763, -0.008593608625233173, 0.032172564417123795, 0.010303330607712269, -0.00016255091759376228, -0.04063175991177559, -0.055882539600133896, 0.03630683198571205, -0.04540469869971275, 0.009205366484820843, -0.0364503413438797, -0.043618690222501755, -0.049840543419122696, -0.05874014273285866, 0.014655211940407753, -0.004108708817511797, -0.06568213552236557, -0.02320985496044159, 0.03115367516875267, 0.0665626972913742, -0.055384717881679535, -0.06321826577186584, 0.015724070370197296, -0.0335838682949543, 0.018506351858377457, 0.04019584879279137, -0.023137597367167473, 0.0022704608272761106, -0.06324262917041779, -0.04196622222661972, 0.037417054176330566, -0.015871241688728333, -0.022282952442765236, 0.02437344193458557, 0.04538268595933914, 0.010246211662888527, -0.0029208746273070574, 0.04818818345665932, -0.04219778999686241, 0.04773644357919693, 0.029819274321198463, 0.030149005353450775, 0.020325973629951477, 0.05965806171298027, -0.050989363342523575, -0.0035876003094017506, -0.0601772777736187, -0.03961917385458946, -0.033701229840517044, 0.015050920657813549, 0.02319352887570858]\n"
     ]
    }
   ],
   "source": [
    "test_embeding_01 = hf.embed_query(\"How do I cancel the order, I have placed?\")\n",
    "print(test_embeding_01)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "64dbabd4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "768"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(test_embeding_01)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "db802654",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[-0.039934318512678146, -0.019825583323836327, 0.013442221097648144, -0.013124741613864899, 0.0005258551682345569, 0.03725496679544449, 0.0025068733375519514, 0.010208738967776299, -0.019530337303876877, 0.0293378047645092, 0.014247575774788857, 0.01453816145658493, 0.040649160742759705, 0.05133731663227081, -0.0088017163798213, 0.029372133314609528, -0.05648595094680786, 0.0018975593848153949, -0.05567377060651779, -0.0029267638456076384, 0.06975752860307693, 0.035901766270399094, -0.009810788556933403, 0.04097669944167137, -0.0031128532718867064, 0.030394675210118294, -0.07211446017026901, 0.00881735235452652, 0.05946117267012596, -0.06474363058805466, 0.007516541518270969, -0.06650260835886002, -0.06294887512922287, -0.02284851484000683, 0.013013351708650589, -0.01996603049337864, -0.010490860790014267, 0.016847366467118263, 0.016591988503932953, 0.03743676468729973, -0.010675443336367607, -0.01723102480173111, -0.0023100855760276318, -0.05627245083451271, 0.01630876585841179, 0.02136887237429619, -0.018646538257598877, -0.035165756940841675, -0.026239294558763504, -0.03177192434668541, -0.04945766180753708, -0.07772766053676605, -0.01630229502916336, -0.02643663063645363, 0.010634290054440498, -0.024757593870162964, -0.0541817843914032, 0.029813354834914207, 0.06952589005231857, -0.034239817410707474, -0.017215821892023087, 0.004084812942892313, -0.08820939809083939, 0.02876022271811962, 0.04704786092042923, -0.07376951724290848, 0.058772243559360504, -0.014666285365819931, -0.004135055001825094, -0.029056552797555923, -0.006044821348041296, -0.0419086255133152, 0.026831524446606636, -0.052570004016160965, -0.026377897709608078, -0.016484517604112625, 0.020268602296710014, 0.01716729998588562, -0.06345999240875244, 0.02137255296111107, -0.019674673676490784, -0.00791500136256218, 0.026509106159210205, -0.04682350531220436, 0.0030045511666685343, 0.01090843603014946, -0.028085919097065926, 0.031186910346150398, -0.017717450857162476, 0.0190531425178051, -0.04519818350672722, -0.036999065428972244, -0.03213847428560257, -0.021974945440888405, -0.014130382798612118, 0.04065713286399841, 0.013783366419374943, 0.006030930206179619, 0.05630044266581535, 0.0276829581707716, 0.050412800163030624, 0.06814716756343842, -0.010937662795186043, 0.030536610633134842, 0.014846468344330788, 0.008131013251841068, -0.022357510402798653, -0.03033132664859295, -0.04660100117325783, -0.012016836553812027, 0.0201692134141922, -0.045154184103012085, -0.005925022531300783, 0.05190907046198845, -0.0212843120098114, -0.02884661965072155, 0.043871331959962845, -0.02433999814093113, -0.048796601593494415, -0.0349387601017952, 0.031171739101409912, 0.015623584389686584, -0.027978064492344856, -0.025792554020881653, -0.05516708642244339, 0.031294167041778564, -0.03543059527873993, -0.01178639568388462, 0.00298991403542459, 0.004385795909911394, 0.03212915360927582, 0.028720183297991753, 0.001408896641805768, -0.07650378346443176, 0.012198422104120255, 0.035202790051698685, -0.015749886631965637, 0.03951689973473549, -8.343667286681011e-05, 0.09867773950099945, -0.0652642473578453, -0.04256579652428627, -0.029012205079197884, -0.0017993941437453032, -0.016775771975517273, 0.02670898847281933, 0.059302449226379395, -0.05243738368153572, -0.05846966803073883, -0.01637376844882965, 0.04863825812935829, -0.05428996682167053, -0.018685242161154747, 0.0737043172121048, -0.0003141260822303593, 0.010278952307999134, -0.03391134366393089, -0.0026514220517128706, -0.03580476716160774, -0.02385835163295269, -0.029823701828718185, 0.0382530502974987, -0.014265425503253937, -0.02324913814663887, -0.04929158464074135, -0.024328837171196938, 0.01996438577771187, 0.05808272212743759, -0.0023957903031259775, 0.013064838945865631, -0.03973018750548363, 0.036911025643348694, 0.04015040397644043, 0.03953634575009346, 0.028285378590226173, -0.0038960070814937353, 0.03632253780961037, -0.005228034686297178, -0.03778524324297905, 0.05228511244058609, -0.024743476882576942, -0.031838592141866684, -0.06124860793352127, 0.03888997435569763, 0.06101526319980621, -0.020137162879109383, 0.015713006258010864, 0.03037474863231182, 0.018522266298532486, -0.020828919485211372, -0.00037373267696239054, 0.03435168415307999, 0.02181665226817131, -0.02312580682337284, 0.028136642649769783, 0.0022531067952513695, -0.008646511472761631, -0.01233457401394844, -0.05419773608446121, -0.00631378497928381, -0.03955982252955437, -0.003842591308057308, 0.0332590714097023, 0.00481483293697238, 0.0017353856237605214, 0.06846749037504196, -0.02123619243502617, 0.06817404925823212, -0.024037782102823257, -0.020575039088726044, -0.03153061866760254, -0.023211432620882988, -0.01989716850221157, 0.06542938947677612, 0.06832081079483032, 0.043293315917253494, -0.039536770433187485, -0.06198401004076004, 0.03378792479634285, 0.06505222618579865, 0.05937663093209267, 0.008152819238603115, -0.02464935928583145, 0.0025673015043139458, 0.021531684324145317, 0.05353088304400444, -0.04640842229127884, -0.02826370671391487, -0.03371981531381607, 0.035673778504133224, -0.043613553047180176, 0.0077782608568668365, 0.0006885311449877918, 0.03119661472737789, -0.03608514368534088, -0.03889821469783783, 0.0521712489426136, 0.021178897470235825, -0.01652640290558338, 0.013632113113999367, -0.03152281045913696, 0.0085225785151124, 0.06302151083946228, 0.011650805361568928, 0.0035208037588745356, -0.06716369092464447, 0.031048433855175972, -0.002303004264831543, 0.06827550381422043, -0.027662472799420357, 0.04550491273403168, 0.012224900536239147, 0.005602401681244373, 0.005767996422946453, 0.012041384354233742, 0.04484378546476364, 0.08367165923118591, 0.018818337470293045, -0.03901929408311844, 0.04794180765748024, 0.04077179729938507, 0.06093830242753029, 0.06143375113606453, -0.007450830191373825, 0.08126535266637802, -0.02549959160387516, 0.06518571078777313, 0.03199326992034912, 0.005145874805748463, -0.025059614330530167, 0.04617610201239586, 0.04434453323483467, -0.010881583206355572, -0.010725622065365314, 0.04427335038781166, -0.043226566165685654, 0.04304804652929306, -0.01007834728807211, -0.033640649169683456, 0.012492738664150238, -0.0014285328797996044, 0.07248996943235397, -0.004145535174757242, -0.0027282291557639837, -0.0076331691816449165, -0.03417478874325752, -0.0017675342969596386, 0.01837361976504326, -0.0030088527128100395, -0.00717508140951395, 0.010023251175880432, -0.0038194500375539064, 0.01645565964281559, -0.05669466778635979, -0.03457538038492203, -0.037890929728746414, -0.029793735593557358, -0.010173712857067585, -0.06143246218562126, -0.007195654790848494, -0.07388995587825775, -0.032087650150060654, 0.0476703904569149, 0.04041864722967148, 0.023302597925066948, -0.039397723972797394, -0.0009951997781172395, -0.022165648639202118, -0.02065945602953434, -0.04149802029132843, -0.011439532972872257, -0.028173649683594704, -0.05246710777282715, 0.008995353244245052, 0.06346911936998367, 0.022268392145633698, 0.0019767703488469124, -0.022728143259882927, -0.028191139921545982, -0.01580815017223358, 0.0380968414247036, 0.06658053398132324, -0.02816837467253208, -0.04213067516684532, 0.019593702629208565, -0.005087325815111399, 0.02405473217368126, -0.05788682401180267, -0.06458408385515213, 0.050842560827732086, 0.040586814284324646, 0.009556573815643787, -0.015375101007521152, -0.006497774738818407, -0.026127835735678673, -0.03863666579127312, -0.033951543271541595, -0.02928314357995987, -0.029609911143779755, -0.03136422857642174, -0.04252828657627106, -0.021637026220560074, -0.06031771004199982, 0.004082042723894119, -0.014333005994558334, -0.009027957916259766, 0.039358485490083694, 0.03959297388792038, 0.03353291377425194, 0.021006211638450623, -0.01379657257348299, -0.04680434241890907, 0.0409315787255764, -0.012665976770222187, -0.022821081802248955, -0.043383147567510605, -0.07387068122625351, 0.032032862305641174, 0.026617951691150665, -0.001836538314819336, -0.026298070326447487, 0.02461746335029602, 0.016702184453606606, -0.003255179151892662, -0.0004508246493060142, -0.019101878628134727, -0.027093326672911644, -0.031106872484087944, 0.00274557969532907, -0.031883515417575836, -0.050096314400434494, -0.008085362613201141, -0.020990528166294098, 0.04932417720556259, -0.06833931058645248, -0.04691362753510475, -0.03133295848965645, -0.009498928673565388, 0.015959160402417183, 0.023325590416789055, -0.04073389247059822, -0.009127181023359299, -0.0472855418920517, -0.023135237395763397, -0.01403192151337862, 0.00441196421161294, 0.018592888489365578, 0.024827150627970695, 0.006528473924845457, 0.014593220315873623, 0.0300112534314394, -0.003769590985029936, 0.052644502371549606, 0.008683252148330212, -0.0469258688390255, 0.0361393466591835, -0.0012102219043299556, 0.010212531313300133, -0.017610840499401093, -0.011845465749502182, -0.06740155816078186, -0.1304635852575302, -0.07022679597139359, 0.03729679435491562, 0.002731130225583911, -0.016216697171330452, 0.02564847655594349, -0.051412079483270645, -0.015910815447568893, -0.007468256633728743, 0.03424031659960747, 0.006682178471237421, -0.015443096868693829, 0.027996262535452843, 0.010342243127524853, 0.027627984061837196, -0.025295808911323547, -0.012437871657311916, -0.0207903441041708, -0.02782372012734413, -0.03073798306286335, 0.05673249438405037, 0.027527201920747757, 0.03110915794968605, 0.03746241331100464, 0.009332750923931599, -0.033378925174474716, -0.002210924867540598, 0.02499389834702015, -0.021287495270371437, -0.05783400684595108, -0.03240180015563965, 0.008151925168931484, -0.004929861519485712, -0.006481833755970001, -0.02160288579761982, 0.024160724133253098, 0.05957063287496567, -0.014915806241333485, -0.018596226349473, 0.005322140175849199, 0.008152800612151623, -0.019422054290771484, -0.06591842323541641, 0.028974564746022224, 0.04967188835144043, -0.014199791476130486, 0.015583183616399765, 0.04429931193590164, 0.005964867305010557, 0.031382836401462555, 0.04421907663345337, -0.0325995609164238, -0.053749676793813705, 0.018750447779893875, -0.008371162228286266, -0.02565133385360241, -0.050036195665597916, -0.06650763005018234, -0.0074496339075267315, 0.03205893188714981, 0.0014350760029628873, -0.07401164621114731, 0.03641184791922569, 0.058255065232515335, -0.023505276069045067, 0.015017952769994736, 0.023084964603185654, 0.03286964073777199, 0.04462329298257828, -0.010912487283349037, 0.025824157521128654, -0.02104230411350727, -0.01780710741877556, -0.02103503793478012, 0.022140080109238625, 0.007294625509530306, -0.0633726418018341, -0.06444664299488068, 0.004064182285219431, 0.036399055272340775, 0.028219236060976982, 0.03613480180501938, -0.031221671029925346, -0.021223850548267365, -0.04778982698917389, 0.03683224692940712, -0.0335746593773365, 0.022335510700941086, 0.04387804865837097, 0.03011547215282917, 0.00763259781524539, -0.03106430172920227, 0.02179938741028309, 0.012927859090268612, 0.04028739035129547, 0.006169207394123077, -0.026198547333478928, -0.04930786415934563, 0.02720019221305847, 0.02779148519039154, -0.046842701733112335, -0.09572072327136993, 0.03184898942708969, -0.011082485318183899, -0.020184798166155815, 0.03522218018770218, 0.05569509416818619, 0.031006040051579475, 0.10498803108930588, 0.014050818048417568, -0.011186705902218819, -0.051214344799518585, 0.01768660545349121, -0.08426403254270554, -0.04093330353498459, -0.03504665568470955, -0.06542400270700455, -0.023560315370559692, -0.058845460414886475, -0.05963559076189995, -0.03305533900856972, 0.002150782383978367, 0.022176900878548622, -0.0013954300666227937, 0.05777003988623619, 0.017951417714357376, 0.0032996791414916515, 0.018889471888542175, -0.047383032739162445, -0.004631198476999998, -0.0005328984698280692, -0.0851525142788887, -0.03299587219953537, 0.045075371861457825, -0.007321675308048725, -0.007274671457707882, -0.033335547894239426, -0.00568136852234602, 0.03542109578847885, -0.014220057986676693, -0.020254971459507942, -0.01749498024582863, 0.012957452796399593, -0.044940438121557236, -0.03539712727069855, -0.001451704534702003, 0.02846401184797287, 0.0020368134137243032, -0.03623684123158455, 0.039014000445604324, 0.013622450642287731, -0.03133583441376686, -0.021547747775912285, 0.0601080022752285, 0.03562057390809059, -0.05244689807295799, -0.0334397591650486, 0.005140820983797312, -0.015096360817551613, 0.03597849979996681, -0.011417180299758911, -0.022267986088991165, 0.022204531356692314, 0.027705118060112, 0.03338225185871124, 0.0161166712641716, -0.07022375613451004, 0.029836731031537056, -0.03956544026732445, -0.008989057503640652, -0.01875384710729122, 0.030402472242712975, 0.008843904361128807, 0.01008151937276125, 0.0025063976645469666, 0.0016347273485735059, -0.09255833178758621, 0.05182591825723648, -0.03375726565718651, -0.02679412253201008, -0.012023276649415493, -0.011615394614636898, -0.0223180390894413, 0.04021923243999481, -0.023028258234262466, -0.022152088582515717, -0.0708475410938263, 0.01100330613553524, -0.04835106432437897, -0.004922320134937763, 0.030715255066752434, -0.02714141085743904, -0.04903828352689743, -0.0027584373019635677, -0.03201531246304512, 0.0051005189307034016, 0.0371030792593956, 0.03515026718378067, 0.04800526797771454, 0.0272026639431715, 0.009957649745047092, -0.012679962441325188, 0.010743970051407814, -0.05542105808854103, -0.009109800681471825, 0.015439193695783615, -0.03329866752028465, 0.007587139960378408, 0.022448725998401642, 0.057203322649002075, -0.06339528411626816, -0.0275887381285429, 0.04633779078722, 0.03414660319685936, 0.012622358277440071, -0.013339810073375702, 0.015693336725234985, 0.06739582866430283, 0.028217704966664314, -0.0337195098400116, -0.0069001950323581696, -0.027129393070936203, -0.006245787721127272, -0.01678020879626274, -0.012185423634946346, -0.010541887953877449, 0.009267195127904415, -0.002315608784556389, -0.04406043514609337, 0.06446023285388947, 0.0067278058268129826, 0.03974556550383568, -0.01779351383447647, -0.03981364145874977, 0.05242600664496422, 0.02211637794971466, -0.03991621732711792, 0.03094673343002796, 0.011618874035775661, -0.023578641936182976, 0.046542081981897354, -0.035159461200237274, 0.02374734915792942, 0.05892416089773178, 0.01417032815515995, -0.031585030257701874, 0.020735960453748703, -0.03917723894119263, 0.044180553406476974, 0.03069898672401905, -0.07185571640729904, -0.004721812903881073, -0.03076336905360222, 0.04379932954907417, -0.0777990072965622, 0.06685392558574677, 0.03164806589484215, 0.02861206606030464, 0.02138363942503929, -0.04637119919061661, -0.0672767385840416, 0.014749876223504543, -0.03172701597213745, 0.02129671536386013, -0.040455661714076996, -0.061818260699510574, 0.0673731192946434, 0.020944669842720032, -0.08061369508504868, 0.032496172934770584, 0.020025435835123062, 0.017460428178310394, 0.021234074607491493, 0.025116095319390297, -0.029872801154851913, 0.008779463358223438, -0.016065564006567, 0.01547152642160654, -0.005190067924559116, -0.020228885114192963, 0.010613219812512398, -0.02611883357167244, 0.03145473822951317, 0.06909707933664322, -0.005939817521721125, 0.03535046800971031, -0.0015846258029341698, -0.06139561906456947, -0.051377616822719574, 0.01595730520784855, 0.044126737862825394, 0.0016120478976517916, -0.018701285123825073, -0.04729351028800011, 0.003819900332018733, 0.025564342737197876, 0.014226322993636131, -0.021548809483647346, 0.016865843906998634, 0.008563901297748089, -0.041157595813274384, -0.04728192090988159, 0.04674181342124939, 0.041002340614795685, 0.004948415793478489, 0.03559616953134537, -0.018665272742509842, 0.002069140551611781, 0.02481648698449135, 0.0023301453329622746, 0.01353398710489273, -0.07083351910114288, -0.012016416527330875, 0.028032440692186356, 0.024470418691635132, 0.020504949614405632, -0.010074688121676445, 0.020130107179284096, 0.04982297122478485, 0.01059383898973465, 0.029690677300095558, -0.060566894710063934, -0.0400896780192852, -0.0016048077959567308, -0.056043364107608795, 0.05386972054839134, 0.004354431293904781, -0.06472070515155792, -0.017940528690814972, -0.04106171056628227, 0.020920071750879288, 0.040541116148233414, -0.046589188277721405, 0.034072164446115494, 0.036797042936086655, 0.041436705738306046, -0.013828583993017673, -0.11440390348434448, -0.06839403510093689, -0.0498848520219326, 0.03178105503320694, 0.02485569566488266, -0.04709702357649803, -0.025463737547397614, -0.01057619508355856, -0.018037671223282814, 0.021047594025731087, -0.030371930450201035, -0.011079192161560059, 0.015498224645853043, 0.045227039605379105, -0.052897024899721146, -0.020682375878095627, 0.0378902293741703, -0.03526831418275833, 0.029915926977992058, -0.008645051158964634, 0.00662309629842639, 0.0666625127196312, 0.03383132442831993, 0.0028385298792272806, -0.02309088408946991, -0.01782809942960739, -0.04037242755293846, -0.04795127734541893, -0.018199604004621506, 0.03091822937130928]\n"
     ]
    }
   ],
   "source": [
    "test_embeding_02 = hf.embed_query(\"Hi\")\n",
    "print(test_embeding_02)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "1e157c10",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "768"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(test_embeding_02)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "8cdc1840",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "list"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "type(test_embeding_02)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4fc2b821",
   "metadata": {},
   "source": [
    "As we can see above, the model encodes the given sentence to embeding of length 768 irrespective of the length of sentence. These numbers doesnot make any sense to us but in reality they are capturing the meaning of the sentence."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "120d2c71",
   "metadata": {},
   "source": [
    "### Initilaizing FAISS vectordb, loading and retreiving the data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "56fc1d84",
   "metadata": {},
   "outputs": [],
   "source": [
    "from langchain.vectorstores import FAISS\n",
    "\n",
    "# Create a FAISS instance for vector database from 'data'\n",
    "faiss_vectordb = FAISS.from_documents(documents=faq_data,\n",
    "                                 embedding=hf)\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "ff84db3e",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Create a retriever for querying the vector database\n",
    "faiss_retriever = faiss_vectordb.as_retriever(score_threshold = 0.8)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "b7ed23bf",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[Document(page_content='prompt: How do I cancel the order, I have placed?\\nresponse: Order can be canceled till the same is out for delivery', metadata={'source': 'How do I cancel the order, I have placed?', 'row': 0}),\n",
       " Document(page_content='prompt: How do I check the status of my order?\\nresponse: Please tap on “My Orders” section under main menu of App/Website/M-site to check your order status.', metadata={'source': 'How do I check the status of my order?', 'row': 3}),\n",
       " Document(page_content='prompt: How do I create a Return Request?\\nresponse: You can create a Return in three simple steps\\n1) Tap on MyOrders\\n2) Choose the item to be Returned\\n3) Enter details requested and create a return request', metadata={'source': 'How do I create a Return Request?', 'row': 1}),\n",
       " Document(page_content='prompt: How can I get my order delivered faster?\\nresponse: Sorry, currently we do not have any service available to expedite the order delivery. In future, if we are offering such service and your area pincode is serviceable, you will receive a communication from our end.', metadata={'source': 'How can I get my order delivered faster?', 'row': 4})]"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "faiss_rdocs = faiss_retriever.get_relevant_documents(\"How do I cancel the order, I have placed?\")\n",
    "faiss_rdocs"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4d9a2ff9",
   "metadata": {},
   "source": [
    "### Create RetrievalQA chain along with prompt template 🚀"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "b05a2b77",
   "metadata": {},
   "outputs": [],
   "source": [
    "from langchain.llms import GooglePalm\n",
    "\n",
    "api_key = 'your api key here' # get this free api key from https://makersuite.google.com/\n",
    "\n",
    "llm_palm = GooglePalm(google_api_key=api_key, temperature=0.1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "9e89282e",
   "metadata": {},
   "outputs": [],
   "source": [
    "from langchain.prompts import PromptTemplate\n",
    "\n",
    "prompt_template = \"\"\"Use only the following pieces of context to answer the question at the end.\n",
    "In the answer try to provide as much text as possible from \"response\" section in the source document context without making much changes.\n",
    "If the answer is not found in the context provided, kindly reply back \"I don't know.\" Don't try to make up an answer. at the end of each answer say \". Thanks for asking!\"\n",
    "\n",
    "CONTEXT: {context}\n",
    "\n",
    "QUESTION: {question}\"\"\"\n",
    "\n",
    "\n",
    "PROMPT = PromptTemplate(\n",
    "    template=prompt_template, input_variables=[\"context\", \"question\"]\n",
    ")\n",
    "chain_type_kwargs = {\"prompt\": PROMPT}\n",
    "\n",
    "\n",
    "from langchain.chains import RetrievalQA\n",
    "\n",
    "chain = RetrievalQA.from_chain_type(llm=llm_palm,\n",
    "                            chain_type=\"stuff\",\n",
    "                            retriever=faiss_retriever,\n",
    "                            input_key=\"query\",\n",
    "                            return_source_documents=True,\n",
    "                            chain_type_kwargs=chain_type_kwargs)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "11344655",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'query': 'How do I cancel the order, I have placed?',\n",
       " 'result': 'Order can be canceled till the same is out for delivery. Thanks for asking!',\n",
       " 'source_documents': [Document(page_content='prompt: How do I cancel the order, I have placed?\\nresponse: Order can be canceled till the same is out for delivery', metadata={'source': 'How do I cancel the order, I have placed?', 'row': 0}),\n",
       "  Document(page_content='prompt: How do I check the status of my order?\\nresponse: Please tap on “My Orders” section under main menu of App/Website/M-site to check your order status.', metadata={'source': 'How do I check the status of my order?', 'row': 3}),\n",
       "  Document(page_content='prompt: How do I create a Return Request?\\nresponse: You can create a Return in three simple steps\\n1) Tap on MyOrders\\n2) Choose the item to be Returned\\n3) Enter details requested and create a return request', metadata={'source': 'How do I create a Return Request?', 'row': 1}),\n",
       "  Document(page_content='prompt: How can I get my order delivered faster?\\nresponse: Sorry, currently we do not have any service available to expedite the order delivery. In future, if we are offering such service and your area pincode is serviceable, you will receive a communication from our end.', metadata={'source': 'How can I get my order delivered faster?', 'row': 4})]}"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "chain('How do I cancel the order, I have placed?')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9d60510f",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
